# Tokio 线程操作学习示例

这个项目包含了全面的 Tokio 异步运行时线程操作学习代码，涵盖了 Tokio 的核心概念和实际应用场景。

## 🎯 学习内容

### 1. 基础异步任务和 spawn
- `tokio::spawn` 的基本用法
- 并发执行多个异步任务
- 等待任务完成并获取结果

### 2. JoinHandle 的使用
- 收集和管理多个任务句柄
- 使用 `tokio::join!` 宏同时等待多个任务
- 处理任务返回值

### 3. spawn_blocking 处理阻塞任务
- 使用 `spawn_blocking` 处理 CPU 密集型任务
- 避免阻塞异步运行时
- 异步任务与阻塞任务的协调

### 4. 任务间通信 - mpsc channel
- 多生产者单消费者通道
- 异步消息传递
- 生产者-消费者模式

### 5. 任务间通信 - oneshot channel
- 一次性通道通信
- 任务间结果传递
- 异步计算结果获取

### 6. 错误处理和超时控制
- 任务错误处理
- 超时控制机制
- Panic 捕获和处理

### 7. 并发任务处理
- 批量并发任务执行
- 使用 `futures::future::join_all`
- 结果收集和处理

### 8. 任务取消和优雅关闭
- 任务取消机制
- 使用 `CancellationToken` 进行优雅关闭
- `tokio::select!` 宏的使用

## 🚀 运行方式

```bash
# 克隆或下载项目后，在项目目录中运行：
cargo run
```

## 📦 依赖项

- `tokio` - 异步运行时
- `tokio-util` - Tokio 工具库
- `futures` - Future 工具
- `anyhow` - 错误处理
- `rand` - 随机数生成

## 💡 学习建议

1. **逐步学习**：按照代码中的示例顺序学习，每个示例都有详细的中文注释
2. **实验修改**：尝试修改参数（如延迟时间、任务数量）来观察不同的行为
3. **添加日志**：可以添加更多的 `println!` 来观察执行流程
4. **错误处理**：注意观察各种错误处理场景的输出

## 🔍 关键概念

- **异步任务**：使用 `async/await` 语法的非阻塞任务
- **并发 vs 并行**：理解 Tokio 的并发模型
- **任务调度**：Tokio 运行时如何调度任务
- **通道通信**：任务间安全的数据传递方式
- **错误传播**：异步环境中的错误处理模式

这个项目为学习 Tokio 提供了一个完整的起点，涵盖了实际开发中最常用的模式和技术。